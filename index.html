<!DOCTYPE html>
<html lang="he">
<!-- Set the language of the document to Hebrew -->

<head>
  <!-- Start of the head section -->
  <meta charset="UTF-8">
  <!-- Specifies the character encoding for the document -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- Configures viewport for responsiveness -->
  <title>לוח שנה שבועי נוכחות - כניסה</title>
  <!-- Sets the title of the page, translated to Hebrew -->
  <style>
    /* Styles for the login page and calendar */
    body {
      font-family: Arial, sans-serif;
      /* Sets a generic sans-serif font, with Arial as a specific option */
      margin: 0;
      /* Remove default body margin */
      padding: 0;
      /* Remove default body padding */
      background-color: #f4f4f4;
      /* Sets a light gray background color*/
      direction: rtl;
      /* Sets the default text direction to right-to-left for Hebrew */
      display: flex;
      /* Use flexbox for centering */
      justify-content: center;
      /* Center content horizontally */
      align-items: center;
      /* Center content vertically */
      min-height: 100vh;
      /* Ensure the content takes at least the full viewport height */
    }

    .login-container {
      background-color: #fff;
      /* Sets a white background color */
      padding: 20px;
      /* Adds padding inside the container */
      border-radius: 8px;
      /* Rounds the corners of the container */
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
      /* Adds a subtle box shadow */
      text-align: center;
      /* Center text horizontally */
      max-width: 300px;
      /* Limit the width of the login form */
      width: 100%;
      /* Allow the container to take the full width available */
    }

    .login-container h1 {
      margin-bottom: 20px;
      /* Adds bottom margin to the heading */
    }

    .login-input {
      width: calc(100% - 20px);
      /* Set input width to fill container, minus padding */
      padding: 10px;
      /* Adds padding inside the input */
      margin-bottom: 10px;
      /* Adds bottom margin */
      border: 1px solid #ccc;
      /* Adds border */
      border-radius: 4px;
      /* Rounded corners */
    }

    .login-button {
      width: 100%;
      /* Set button width to fill container */
      padding: 10px;
      /* Adds padding inside the button */
      background-color: #4CAF50;
      /* Sets a green background color */
      color: white;
      /* Sets white text color */
      border: none;
      /* Removes the border */
      border-radius: 4px;
      /* Rounded corners */
      cursor: pointer;
      /* Change cursor to pointer on hover */
    }

    .login-button:hover {
      background-color: #45a049;
      /* Darker green on hover */
    }

    .error-message {
      color: red;
      /* Red text for error messages */
      margin-top: 10px;
      /* Adds top margin */
    }

    /* Styles for the calendar and other elements (after login) */
    .container {
      max-width: 800px;
      /* Sets a maximum width for the content */
      margin: 20px auto;
      /* Centers the container horizontally with top/bottom margin */
      padding: 20px;
      /* Adds padding inside the container */
      background-color: #fff;
      /* Sets a white background color */
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
      /* Adds a subtle box shadow */
      border-radius: 8px;
      /* Rounds the corners of the container */
      display: none;
      /* Initially hidden, shown after successful login */
    }

    .calendar {
      display: grid;
      /* Uses CSS Grid for calendar layout */
      grid-template-columns: repeat(7, 1fr);
      /* Creates 7 equal-width columns for days */
      gap: 10px;
      /* Sets the gap between grid items */
    }

    .day {
      border: 1px solid #ddd;
      /* Adds a light gray border to each day */
      padding: 10px;
      /* Adds padding inside each day */
      text-align: center;
      /* Centers the text within each day */
      background-color: #f9f9f9;
      /* Light gray background for days */
    }

    .day-header {
      font-weight: bold;
      /* Make day header text bold */
      margin-bottom: 5px;
      /* Add space below header */
      background-color: #eee;
      /* Slightly darker background for headers */
      padding: 5px;
      /* Padding for the day headers */
    }

    .name-list {
      margin-top: 10px;
      /* Adds space above the name list */
      text-align: right;
      /* Align names to the right for Hebrew */
    }

    .name {
      padding: 2px 5px;
      /* Adds padding around each name */
      margin: 2px 0;
      /* Margin between names */
      display: inline-block;
      /* Displays names inline-block */
      border-radius: 3px;
      /* Slightly rounded corners for name tags */
      cursor: pointer;
      /* Change cursor to pointer on hover */
    }

    .on-base {
      background-color: green;
      /* Green background for "on base" */
    }

    .request {
      background-color: yellow;
      /* Yellow background for "request" */
    }

    .sick {
      background-color: red;
      /* Red background for "sick" */
      color: white;
      /* White text for better contrast on Red */
    }

    .totals {
      margin-top: 10px;
      /* Adds space above the totals */
      font-weight: bold;
      /* Bold text for totals */
    }

    /* Style for the name management section */
    .name-management {
      margin-bottom: 20px;
      /* Adds bottom margin */
      border: 1px solid #ddd;
      /* Adds border */
      padding: 10px;
      /* Adds padding */
      background-color: #f9f9f9;
      /* Light gray background */
    }

    /* Style for individual name inputs */
    .name-input {
      margin-right: 5px;
      /* Adds right margin */
      padding: 5px;
      /* Adds padding */
      border: 1px solid #ccc;
      /* Adds border */
      border-radius: 4px;
      /* Rounded corners */
    }

    /* Responsive adjustments */
    @media (max-width: 600px) {
      .calendar {
        grid-template-columns: repeat(1, 1fr);
        /* Stack days vertically on small screens */
      }
    }
  </style>
  <!-- End of the style section -->
</head>

<body>
  <!-- Start of the body section -->

  <!-- Login Container -->
  <div class="login-container" id="loginContainer">
    <!-- Container for the login form -->
    <h1>כניסה</h1>
    <!-- Login heading, translated to Hebrew -->
    <input type="text" id="username" class="login-input" placeholder="שם משתמש">
    <!-- Username input field, with Hebrew placeholder -->
    <input type="password" id="password" class="login-input" placeholder="סיסמה">
    <!-- Password input field, with Hebrew placeholder -->
    <button onclick="checkLogin()" class="login-button">כניסה</button>
    <!-- Login button, translated to Hebrew -->
    <p id="errorMessage" class="error-message"></p>
    <!-- Paragraph for displaying error messages -->
  </div>

  <!-- Main container for the content (initially hidden) -->
  <div class="container" id="calendarContainer">
    <!-- Main container for the content -->
    <h1>לוח שנה שבועי נוכחות</h1>
    <!-- Main heading, translated to Hebrew -->

    <!-- Name Management Section -->
    <div class="name-management">
      <!-- Container for name management -->
      <label for="namesInput">ניהול שמות (מופרדים בפסיק):</label>
      <!-- Label for names input, translated to Hebrew -->
      <input type="text" id="namesInput" placeholder="דוד, רות, משה">
      <!-- Text input for names, with Hebrew placeholder -->
      <button onclick="updateNames()">עדכן שמות</button>
      <!-- Button to update the names, translated to Hebrew -->
    </div>

    <div class="calendar" id="calendar">
      <!-- Calendar container -->
      <!-- Calendar days will be dynamically added here -->
    </div>
  </div>

  <script>
    // Start of the script section

    // Credentials for login
    const validCredentials = [ // Array of valid username/password combinations
      { username: "מבצעית", password: "435" },
      { username: "מסייעת", password: "435" },
      { username: "רובאית", password: "435" },
      { username: "פלחוד", password: "435" },
    ];

    // Function to check login credentials
    function checkLogin() {
      const usernameInput = document.getElementById('username'); // Get the username input element
      const passwordInput = document.getElementById('password'); // Get the password input element
      const errorMessage = document.getElementById('errorMessage'); // Get the error message element
      const loginContainer = document.getElementById('loginContainer'); // Get login container
      const calendarContainer = document.getElementById('calendarContainer');    //Get calendar container

      const enteredUsername = usernameInput.value; // Get the entered username
      const enteredPassword = passwordInput.value; // Get the entered password

      let isValid = false; // Initialize a flag to check if the login is valid
      for (const credentials of validCredentials) { // Loop through the valid credentials
        if (credentials.username === enteredUsername && credentials.password === enteredPassword) { // Check if entered credentials match any valid credentials
          isValid = true; // Set the flag to true if a match is found
          break; // Exit the loop since a match is found
        }
      }

      if (isValid) {
        // If login is valid
        loginContainer.style.display = 'none'; // Hide login form
        calendarContainer.style.display = 'block';  //Show calendar
        init(); // Initialize the calendar
      } else {
        // If login is invalid
        errorMessage.textContent = "שם משתמש או סיסמה שגויים"; // Display error message, translated to Hebrew
      }
    }



    let globalNames = ["אליס", "בוב", "צ'רלי"]; // Initialize global names array with Hebrew names
    let currentDate = new Date(); // Get the current date

    // Function to get an array of 7 days starting from the current date
    function getWeekDates(startDate) {
      const weekDates = []; // Initialize an empty array to store the dates
      for (let i = 0; i < 7; i++) { // Loop 7 times to get 7 days
        const date = new Date(startDate); // Create a new Date object from the startDate
        date.setDate(startDate.getDate() + i); // Increment the date by i days
        weekDates.push(date); // Add the date to the array
      }
      return weekDates; // Return the array of dates
    }

    // Function to format date as "Day, DD/MM"
    function formatDate(date) {
      const daysOfWeek = ['ראשון', 'שני', 'שלישי', 'רביעי', 'חמישי', 'שישי', 'שבת']; // Array of days in Hebrew
      const dayOfWeek = daysOfWeek[date.getDay()]; // Get the day of the week in Hebrew
      const dayOfMonth = date.getDate(); // Get the day of the month
      const month = date.getMonth() + 1; // Get the month (getMonth() is 0-indexed)
      return `${dayOfWeek}, ${dayOfMonth}/${month}`; // Return the formatted date string
    }

    // Function to update the global names array
    function updateNames() {
      const namesInput = document.getElementById('namesInput'); // Get the names input element
      const newNames = namesInput.value.split(',').map(name => name.trim()).filter(name => name !== ""); // Split string into array, trim whitespace, and remove empty strings
      if (newNames.length > 0) { // Check if there are any names after processing
        globalNames = newNames; // Update global names array with new names
        renderCalendar(); // Re-render the calendar with updated names
      }
      namesInput.value = globalNames.join(', '); // Update the input field with current names
    }

    // Function to render the calendar
    function renderCalendar() {
      const calendar = document.getElementById('calendar'); // Get the calendar container element
      calendar.innerHTML = ''; // Clear the calendar
      const weekDates = getWeekDates(currentDate); // Get the array of 7 dates for the current week

      for (const date of weekDates) { // Loop through each date in the weekDates array
        const dayElement = document.createElement('div'); // Create a new div for the day
        dayElement.classList.add('day'); // Add the 'day' class to the div
        dayElement.innerHTML = `<div class="day-header">${formatDate(date)}</div>`; // Add the formatted date as the header

        const nameList = document.createElement('div'); // Create a div for the name list
        nameList.classList.add('name-list'); // Add the 'name-list' class

        let onBaseCount = 0; // Initialize on-base count
        let requestCount = 0; // Initialize request count
        let sickCount = 0; // Initialize sick count

        for (const name of globalNames) { // Iterate through the global names array
          const nameElement = document.createElement('span'); // Create a span for each name
          nameElement.classList.add('name'); // Add the 'name' class
          nameElement.textContent = name; // Set the name as text content
          nameElement.classList.add('on-base'); // Default to on-base
          onBaseCount++;  // Increment on-base count

          nameElement.addEventListener('click', function() { // Add click event listener to toggle status
            if (nameElement.classList.contains('on-base')) { // Check if current status is on-base
              nameElement.classList.remove('on-base'); // Remove on-base class
              nameElement.classList.add('request'); // Add request class
              onBaseCount--; // Decrement on-base count
              requestCount++; // Increment request count
            } else if (nameElement.classList.contains('request')) { // Check if current status is request
              nameElement.classList.remove('request'); // Remove request class
              nameElement.classList.add('sick'); // Add sick class
              requestCount--; // Decrement request count
              sickCount++; // Increment sick count
            } else { // If not on-base or request, must be sick
              nameElement.classList.remove('sick'); // Remove sick class
              nameElement.classList.add('on-base'); // Add on-base class
              sickCount--; // Decrement sick count
              onBaseCount++; // Increment on-base count
            }
            updateTotals(dayElement, onBaseCount, requestCount, sickCount); // Update the totals for the day
          });

          nameList.appendChild(nameElement); // Append the name element to the name list
        }

        dayElement.appendChild(nameList); // Append the name list to the day element

        const totalsElement = document.createElement('div'); // Create a div for totals
        totalsElement.classList.add('totals'); // Add the 'totals' class
        totalsElement.textContent = `בבסיס: ${onBaseCount}, בקשה: ${requestCount}, חולה: ${sickCount}`; // Set initial totals text, translated to Hebrew

        dayElement.appendChild(totalsElement); // Append totals to the day element

        calendar.appendChild(dayElement); // Append the day element to the calendar
      }
    }

    // Function to update totals for a specific day
    function updateTotals(dayElement, onBaseCount, requestCount, sickCount) {
      const totalsElement = dayElement.querySelector('.totals'); // Find the totals element within the day
      totalsElement.textContent = `בבסיס: ${onBaseCount}, בקשה: ${requestCount}, חולה: ${sickCount}`; // Update the totals text, translated to Hebrew
    }

    // Function to advance to the next day
    function nextDay() {
      currentDate.setDate(currentDate.getDate() + 1); // Increment the current date by one day
      renderCalendar(); // Re-render the calendar with the new date
    }

    // Initialize with some sample data (optional) and set default names
    function init() {
      const namesInput = document.getElementById('namesInput'); // Get the names input element
      namesInput.value = globalNames.join(', '); // Set the initial names in the input field
      renderCalendar(); // Initial calendar render

      // Set interval to advance to the next day every 24 hours (86400000 milliseconds)
      setInterval(nextDay, 86400000);
    }

  </script>
  <!-- End of the script section -->
</body>
<!-- End of the body section -->

</html
